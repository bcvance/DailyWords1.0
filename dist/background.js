(()=>{let e,o="http://127.0.0.1:8000",t=`https://${chrome.runtime.id}.chromiumapp.org/`,n=Math.random().toString(36).substring(2,15);chrome.runtime.onMessage.addListener((function(o,s,a){if("authorize"===o.message){console.log("authorization triggered");const o=new URL("https://accounts.google.com/o/oauth2/v2/auth");o.searchParams.set("client_id","271850698689-01761jqfpvaaq33640kohv5drfhbnq52.apps.googleusercontent.com"),o.searchParams.set("response_type","id_token"),o.searchParams.set("redirect_uri",t),o.searchParams.set("scope","openid profile email"),o.searchParams.set("nonce",n),chrome.identity.launchWebAuthFlow({url:o.href,interactive:!0},(o=>{if(o){const t=o.split("#")[1],n=new URLSearchParams(t).get("id_token").split(".")[1].replace("-","+").replace("_","/"),s=JSON.parse(atob(n));e=s,console.log("token",s)}}))}})),console.log("test1"),chrome.runtime.onInstalled.addListener((()=>{chrome.storage.sync.get({activated:!1},(function(e){console.log(e.activated),chrome.storage.sync.set({activated:e.activated},(()=>{console.log("activated stored")}))}))})),chrome.runtime.onMessage.addListener((function(t,n,s){return"save"===t.type?(console.log("save "+t.word+" "+t.translation),fetch(o+"/api/save",{method:"POST",body:JSON.stringify({word:t.word,translation:t.translation,userInfo:e})}).then((e=>e.json())).then((e=>console.log(e))).catch((e=>console.log(e))),!0):"delete"===t.type?(console.log("delete "+t.word+" "+t.translation),fetch(o+"/api/delete",{method:"POST",body:JSON.stringify({word:t.word,userInfo:e})}).then((e=>e.json())).then((e=>console.log(e))).catch((e=>console.log(e))),!0):void 0}))})();