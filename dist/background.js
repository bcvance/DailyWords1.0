(()=>{let e="http://127.0.0.1:8000",o={},t=`https://${chrome.runtime.id}.chromiumapp.org/`,s=Math.random().toString(36).substring(2,15);chrome.runtime.onMessage.addListener((function(e,o,n){if("authorize"===e.message){console.log("authorization triggered");const e=new URL("https://accounts.google.com/o/oauth2/v2/auth");e.searchParams.set("client_id","271850698689-01761jqfpvaaq33640kohv5drfhbnq52.apps.googleusercontent.com"),e.searchParams.set("response_type","id_token"),e.searchParams.set("redirect_uri",t),e.searchParams.set("scope","openid profile email"),e.searchParams.set("nonce",s),chrome.identity.launchWebAuthFlow({url:e.href,interactive:!0},(e=>{if(e){const o=e.split("#")[1],t=new URLSearchParams(o).get("id_token").split(".")[1].replace("-","+").replace("_","/"),s=JSON.parse(atob(t));console.log("token",s)}}))}})),console.log("test1"),chrome.runtime.onInstalled.addListener((()=>{chrome.storage.sync.get({words:o},(function(e){console.log(e.words),chrome.storage.sync.set({words:e.words},(()=>{console.log("words stored")}))})),chrome.storage.sync.get({activated:!1},(function(e){console.log(e.activated),chrome.storage.sync.set({activated:e.activated},(()=>{console.log("activated stored")}))}))})),chrome.runtime.onMessage.addListener((function(o,t,s){return"save"===o.type?(console.log("save "+o.word+" "+o.translation),fetch(e+"/api/save",{method:"POST",body:JSON.stringify({word:o.word,translation:o.translation})}).then((e=>e.json())).then((e=>console.log(e))).catch((e=>console.log(e))),!0):"delete"===o.type?(console.log("delete "+o.word+" "+o.translation),fetch(e+"/api/delete",{method:"POST",body:JSON.stringify({word:o.word})}).then((e=>e.json())).then((e=>console.log(e))).catch((e=>console.log(e))),!0):void 0}))})();